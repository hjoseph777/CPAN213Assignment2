<%- include('../partials/header') %>

<!-- Course Management Page -->
<div class="page-header">
    <h1 class="page-title">
        <i class="fas fa-graduation-cap"></i> Course Management
    </h1>
    <p class="page-subtitle">Add, edit, and manage your academic courses</p>
</div>

<!-- Statistics Dashboard -->
<div class="stats-container">
    <div class="stat-card">
        <div class="stat-icon">
            <i class="fas fa-graduation-cap"></i>
        </div>
        <div class="stat-number"><%= totalCourses || 0 %></div>
        <div class="stat-label">Active Courses</div>
    </div>
    
    <div class="stat-card">
        <div class="stat-icon">
            <i class="fas fa-clock"></i>
        </div>
        <div class="stat-number">
            <% if (typeof courses !== 'undefined' && courses.length > 0) { %>
                <%= courses.reduce((sum, course) => sum + course.credits, 0) %>
            <% } else { %>
                0
            <% } %>
        </div>
        <div class="stat-label">Total Credits</div>
    </div>
    
    <div class="stat-card">
        <div class="stat-icon">
            <i class="fas fa-calendar-alt"></i>
        </div>
        <div class="stat-number">3</div>
        <div class="stat-label">Semesters</div>
    </div>
</div>

<!-- Course Listing -->
<% if (typeof courses !== 'undefined' && courses.length > 0) { %>
    <div class="course-grid">
        <% courses.forEach(function(course) { %>
            <div class="course-card">
                <!-- Course Header with gradient background -->
                <div class="course-card-header">
                    <div class="course-header-top">
                        <div class="course-code"><%= course.courseCode %></div>
                        <div class="status-badge status-<%= course.isActive ? 'active' : 'inactive' %>">
                            <%= course.isActive ? 'Active' : 'Inactive' %>
                        </div>
                    </div>
                    <div class="course-name"><%= course.courseName %></div>
                    <div class="course-credits">
                        <i class="fas fa-star"></i> <%= course.credits %> 
                        <%= course.credits === 1 ? 'credit' : 'credits' %>
                    </div>
                </div>
                
                <!-- Course Details -->
                <div class="course-card-body">
                    <div class="course-info">
                        <% if (course.instructor && course.instructor.trim()) { %>
                            <div class="course-info-item">
                                <i class="fas fa-user-tie"></i>
                                <span><strong>Instructor:</strong> <%= course.instructor %></span>
                            </div>
                        <% } %>
                        
                        <div class="course-info-item">
                            <i class="fas fa-calendar-check"></i>
                            <span><strong>Semester:</strong> <%= course.semester || 'Fall' %></span>
                        </div>
                        
                        <% if (course.description && course.description.trim()) { %>
                            <div class="course-info-item">
                                <i class="fas fa-info-circle"></i>
                                <span><strong>Description:</strong> <%= course.description.substring(0, 100) %><%= course.description.length > 100 ? '...' : '' %></span>
                            </div>
                        <% } %>
                        
                        <div class="course-info-item">
                            <i class="fas fa-check-circle <%= course.isActive ? 'text-success' : 'text-danger' %>"></i>
                            <span><strong>Status:</strong> <%= course.isActive ? 'Active' : 'Inactive' %></span>
                        </div>
                        
                        <div class="course-info-item">
                            <i class="fas fa-clock"></i>
                            <span><strong>Added:</strong> <%= new Date(course.createdAt).toLocaleDateString() %></span>
                        </div>
                    </div>
                    
                    <!-- Action Buttons -->
                    <div class="course-actions">
                        <a href="/courses/<%= course._id %>" class="btn btn-primary btn-sm" title="View Course Details">
                            <i class="fas fa-eye"></i> View
                        </a>
                        
                        <a href="/courses/<%= course._id %>/edit" class="btn btn-secondary btn-sm" title="Edit Course">
                            <i class="fas fa-edit"></i> Edit
                        </a>
                        
                        <form method="POST" action="/courses/<%= course._id %>?_method=DELETE" 
                              onsubmit="return confirm('Are you sure you want to delete <%= course.courseCode %>? This action cannot be undone.')" 
                              style="display: inline;">
                            <button type="submit" class="btn btn-danger btn-sm" title="Delete Course">
                                <i class="fas fa-trash-alt"></i> Delete
                            </button>
                        </form>
                        
                        <!-- API Link for testing -->
                        <a href="/courses/<%= course._id %>/api" class="btn btn-warning btn-sm" title="View JSON API" target="_blank">
                            <i class="fas fa-code"></i> API
                        </a>
                    </div>
                </div>
            </div>
        <% }); %>
    </div>
    
    <!-- Additional Actions -->
    <div style="text-align: center; margin-top: 3rem;">
        <a href="/courses/new" class="btn btn-primary btn-lg">
            <i class="fas fa-plus-circle"></i> Add Another Course
        </a>
        <a href="/courses/api" class="btn btn-secondary btn-lg" target="_blank">
            <i class="fas fa-download"></i> Export as JSON
        </a>
    </div>
    
<% } else { %>
    <!-- Empty State - No courses yet -->
    <div class="empty-state">
        <i class="fas fa-book-open"></i>
        <h3>No Courses Found</h3>
        <p>Your course catalog is empty. Start building your academic program by adding your first course.</p>
        <a href="/courses/new" class="btn btn-primary btn-lg" style="margin-top: 1.5rem;">
            <i class="fas fa-plus-circle"></i> Add Your First Course
        </a>
    </div>
<% } %>

<%- include('../partials/footer') %>